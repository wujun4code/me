---
date: "2018-09-17"
title: "NGUI 复刻风声卡牌游戏的 Demo"
category: "Unity"
---

<!-- TOC -->

- [风声桌游的前世今生](#风声桌游的前世今生)
- [用 Unity 试着复刻一下](#用-unity-试着复刻一下)
    - [NGUI 的巧妙设计](#ngui-的巧妙设计)
    - [UIPanel & Sprite](#uipanel--sprite)
- [简略介绍](#简略介绍)
    - [用 .NET Core 写服务端](#用-net-core-写服务端)
    - [Unity 客户端预览](#unity-客户端预览)
- [总结](#总结)

<!-- /TOC -->

## 风声桌游的前世今生

提笔说起这款游戏，真是满是眼泪啊。

首先我们介绍一下《风声桌游》，它是由广州千祺动漫发行的，设计师金恩国设计的一款谍战背景的桌游，

> 我个人评价：他比三国杀好玩的不止一个境界，加上同事同学每次安利之后，他们都纷纷称赞。

但是它生命周期太短，线下没火起来，但是不妨碍他有自己的线上版本，广州千智(千祺旗下品牌)自主研发了风声的线上版版，本来想与盛大的《三国杀》可以一战高下，正当决战时，腾讯切入战场，宣布收购千智的《风声》线上版本，纳入 QQ 游戏与 QQ 斗地主处于统一产品线，然后在 QQ 运营了不到三年之后，2014 年宣布停服，下线。

老玩家泪目啊。

相关的玩法介绍视频可以参照如下：

这是桌游版本的教学视频：

`video: https://www.youtube.com/embed/uQsnYkaGOV4`

这是 QQ 和 千智合作开发的线上版本：

`video: https://www.youtube.com/embed/voO-n2mJ4RE`


## 用 Unity 试着复刻一下

因为也接触了 Unity 好几年的时间，一直懒得去专研游戏开发，最近忽然来了一点兴趣，就开始动手想实现一下，跟所有初学 Unity GUI 开发的同学一样，遇到了一个懵逼的问题：

Unity 的生态里面有两套 GUI 系统：一个是自 4.6 依赖由官方大力出奇迹开发迭代的 UGUI 和一个是已经在 Unity 3.x 的时代就统治江湖的 NGUI，江湖上流传着各种谁谁谁好用的传说，最后在我得知炉石传说也是用 NGUI 做的时候，我果断的放血购买了 NGUI 的正版授权，接近 700 大洋，心在流血，但是用完之后，感觉怎么才 700 这么便宜。

### NGUI 的巧妙设计

NGUI 充分的利用了 Unity 的组件化思想来构建每一个 GUI 元素，在游戏引擎的设计思想里面，已经在很多 Web 前端框架觉醒之前的十几年就开始了基于模块化的设计，在 NGUI 和 Unity 的世界里：

- 外观是模块
- 颜色是模块
- 按钮响应事件是模块
- 鼠标事件是模块
- 动画是模块
- 所有可以成为模块的都应该是模块

基于上述设计理念，一个游戏不管是什么类型的，RPG 也好，卡牌也好，最终它都应该是各种 GUI 拼接展现而成，而 GUI 本身也是由各种模块构建出来的。

### UIPanel & Sprite

其实这个跟我熟悉的 WPF 就有点相似了，在微软的设计理念，左右客户端的展现的控件（GUI 元素）都应该是基于一个基类，这个基类(Panel)默认是透明的，四四方方的，当你需要一个按钮的时候，你只要给这个基类附着上鼠标点击事件，再添加一个 Text（Text 也是基于 Panel 的）就做成了一个按钮，NGUI 更是如此（其实 UGUI 也是如此），粗略的读了一遍 NGUI 的源码，还是有助于你自己构建符合你自己需要的控件。

Sprite 是我熟悉又陌生的东西，XNA 里面也有这个……末代的微软游戏引擎，泪目。

## 简略介绍

首先要解决服务端的问题，游戏服务端我分析过，现如今还自己写服务端架构约等于找死，但是我的目的就是学习一下 NGUI 的用法， 并不是要做一款游戏，做游戏实在是太复杂了，我对游戏一直抱着敬畏之心，不敢说一个人能做完一款游戏，但是尝试实现一些关键的技术细节还是很有挑战性的。

### 用 .NET Core 写服务端

因为服务端和客户端用同一个基础框架和语言可以带来开发的便利性，另外 .NET Core 的性能可能跟 Java 差不多，基于 WebSocket 写一个在线的多人卡牌游戏也不是问题。

### Unity 客户端预览

限于篇幅，本文不做过多技术上的分享，服务端和客户端源码都会在 Github 上开源，先看个预览视频吧：

`video: https://www.youtube.com/embed/DBSyv_1iBGE`


## 总结

算是第一次从零开始去思考一个游戏的开发，再次对组件化的 UI 客户端开发有了进一步的拓展，另外假设服务端和客户端用同一门语言编程的体验真的很棒，可惜 .NET Core 现在在后端的基础设施还不算完善，不知道有没有可能社区进化出一个可以和 kbEngine 直接 PK 的竞品。

